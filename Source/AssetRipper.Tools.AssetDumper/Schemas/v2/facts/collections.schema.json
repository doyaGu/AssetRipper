{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.assetripper.dev/assetdump/v2/facts/collections.schema.json",
  "title": "AssetDump v2 Collections Facts",
  "description": "Per-collection metadata describing Unity SerializedFiles and embedded built-in resources.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "domain",
    "collectionId",
    "name",
    "platform",
    "unityVersion",
    "endian",
    "bundle",
    "dependencies",
    "assetCount"
  ],
  "properties": {
    "domain": {
      "type": "string",
      "const": "collections"
    },
    "collectionId": {
      "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#/$defs/CollectionID"
    },
    "name": {
      "type": "string",
      "description": "Primary filename (e.g., sharedassets1.assets)."
    },
    "collectionType": {
      "type": "string",
      "enum": [
        "Serialized",
        "Processed",
        "Virtual"
      ],
      "description": "Type of collection: Serialized (from SerializedFile), Processed (generated by AssetRipper processing), or Virtual (base class instance)."
    },
    "friendlyName": {
      "type": "string",
      "description": "Human-friendly scene identifier derived from the project-relative path (drops the leading 'Assets/' prefix, strips '.unity', replaces underscores/hyphens with spaces)."
    },
    "bundleName": {
      "type": "string",
      "description": "Bundle name when sourced from an AssetBundle. Present when the collection originates from a Unity AssetBundle file."
    },
    "filePath": {
      "type": "string",
      "description": "Relative file path for the serialized collection on disk."
    },
    "platform": {
      "type": "string",
      "description": "Unity build target/platform string."
    },
    "unityVersion": {
      "type": "string",
      "description": "Unity player/editor version that produced the SerializedFile (current version after any processing)."
    },
    "originalUnityVersion": {
      "type": "string",
      "description": "Original Unity version before any processing modifications. May differ from unityVersion if the collection was modified."
    },
    "formatVersion": {
      "type": "integer",
      "minimum": 0,
      "description": "SerializedFile header format version controlling table layout and offset width. Only present for SerializedAssetCollection."
    },
    "endian": {
      "type": "string",
      "enum": [
        "LittleEndian",
        "BigEndian"
      ]
    },
    "flagsRaw": {
      "type": "string",
      "description": "Bitflag string describing Unity SerializedFile flags as recorded on disk."
    },
    "flags": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Optional flag set derived from Unity SerializedFile header."
    },
    "isSceneCollection": {
      "type": "boolean",
      "description": "True when the collection originates from a Unity scene file (.unity)."
    },
    "bundle": {
      "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#BundleRef",
      "description": "Reference to the parent Bundle containing this collection. Every collection must belong to a Bundle."
    },
    "scene": {
      "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#SceneRef",
      "description": "Reference to the Scene if this collection is part of one. Present when isSceneCollection is true."
    },
    "collectionIndex": {
      "type": "integer",
      "minimum": 0,
      "description": "Index of this collection within its parent bundle's collection list. Used for maintaining collection order."
    },
    "dependencies": {
      "type": "array",
      "items": {
        "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#/$defs/CollectionID"
      },
      "description": "Ordered list of dependency CollectionIDs. Index 0 is always self-reference for correct correspondence with Unity file indices. Subsequent entries may be null if they could not be resolved."
    },
    "dependencyIndices": {
      "type": "object",
      "additionalProperties": {
        "type": "integer",
        "minimum": 0
      },
      "description": "Map from dependency CollectionID to its index in dependencies array. Provides fast reverse lookup for PPtr reference resolution."
    },
    "assetCount": {
      "type": "integer",
      "minimum": 0,
      "description": "Total number of assets in this collection."
    },
    "source": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "uri": {
          "type": "string",
          "description": "Optional URI describing the physical source of the collection (e.g., file path or resource identifier)."
        },
        "offset": {
          "type": "integer",
          "minimum": 0,
          "description": "Byte offset of the collection data within its source file. Useful for tracking location in large bundle files."
        },
        "size": {
          "type": "integer",
          "minimum": 0,
          "description": "Size in bytes of the collection data within its source file."
        }
      },
      "description": "Physical source location information for this collection, useful for debugging and data provenance tracking."
    },
    "unity": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "builtInClassification": {
          "type": "string",
          "enum": [
            "BUILTIN-EXTRA",
            "BUILTIN-DEFAULT",
            "BUILTIN-EDITOR"
          ],
          "description": "Stable identifier assigned to Unity built-in resources collections. These are special collections containing Unity's default assets (shaders, fonts, icons, etc.)."
        }
      },
      "description": "Unity-specific metadata for special collection types."
    }
  }
}
