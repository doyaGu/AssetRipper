{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.assetripper.dev/assetdump/v2/facts/assemblies.schema.json",
  "title": "AssetDump Assembly Facts",
  "description": "Assembly metadata including DLL paths, version info, and type counts.",
  "$ref": "#/$defs/AssemblyRecord",
  "$defs": {
    "AssemblyRecord": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "domain",
        "pk",
        "name",
        "fullName",
        "scriptingBackend",
        "typeCount",
        "scriptCount",
        "isDynamic",
        "isEditor",
        "assemblyType"
      ],
      "properties": {
        "domain": { "type": "string", "const": "assemblies" },
        "pk": {
          "type": "string",
          "description": "Assembly GUID from ScriptHashing.CalculateAssemblyGuid(), uppercase hex, 32 characters",
          "pattern": "^[0-9A-F]{32}$"
        },
        "name": {
          "type": "string",
          "description": "Assembly simple name from AssemblyDefinition.Name (e.g., Assembly-CSharp)",
          "minLength": 1
        },
        "fullName": {
          "type": "string",
          "description": "Fully qualified assembly name with version, culture, and public key token",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "description": "Assembly version from AssemblyDefinition.Version (e.g., 0.0.0.0)",
          "pattern": "^\\d+\\.\\d+\\.\\d+\\.\\d+$"
        },
        "targetFramework": {
          "type": "string",
          "description": "Target framework identifier (e.g., netstandard2.1, net4.7.1)"
        },
        "scriptingBackend": {
          "type": "string",
          "description": "Scripting backend type from IAssemblyManager.ScriptingBackend",
          "enum": ["Mono", "IL2CPP", "Unknown"]
        },
        "runtime": {
          "type": "string",
          "description": "Runtime version description (e.g., .NET Standard 2.1, .NET Framework 4.7.1)"
        },
        "assemblyType": {
          "type": "string",
          "enum": ["Predefined", "UnityEngine", "UnityExtension", "User", "System"],
          "description": "Type of assembly: Predefined (Assembly-CSharp, etc.), UnityEngine (engine assemblies), UnityExtension (Unity packages), User (custom), System (.NET assemblies)"
        },
        "dllPath": {
          "type": "string",
          "description": "Relative path to exported DLL file"
        },
        "dllSize": {
          "type": "integer",
          "description": "DLL file size in bytes",
          "minimum": 0
        },
        "dllSha256": {
          "type": "string",
          "description": "SHA256 hash of DLL file content",
          "pattern": "^[0-9a-f]{64}$"
        },
        "typeCount": {
          "type": "integer",
          "description": "Number of types defined in this assembly",
          "minimum": 0
        },
        "scriptCount": {
          "type": "integer",
          "description": "Number of MonoScript assets referencing this assembly",
          "minimum": 0
        },
        "isDynamic": {
          "type": "boolean",
          "description": "Whether assembly is dynamically generated (e.g., by IL2CPP/Cpp2IL, runtime compilation)"
        },
        "isEditor": {
          "type": "boolean",
          "description": "Whether assembly is editor-only (typically identified by name pattern like *-Editor)"
        },
        "platform": {
          "type": "string",
          "description": "Target platform (e.g., StandaloneWindows64, Android, iOS)"
        },
        "mscorlibVersion": {
          "type": "integer",
          "description": "Mscorlib major version (2 or 4) if this is mscorlib, from IAssemblyManager.HasMscorlib2",
          "enum": [2, 4]
        },
        "references": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of referenced assembly names (simple names, not full names)"
        },
        "exportType": {
          "type": "string",
          "enum": ["Decompile", "Save", "Skip"],
          "description": "How this assembly was exported: Decompile (ILSpy to C#), Save (DLL to Plugins), Skip (not exported)"
        },
        "isModified": {
          "type": "boolean",
          "description": "Whether assembly was modified by AssetRipper (e.g., polyfills added, forwarding types injected)"
        }
      }
    }
  }
}
