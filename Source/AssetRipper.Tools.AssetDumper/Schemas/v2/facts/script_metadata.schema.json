{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.assetripper.dev/assetdump/v2/facts/script_metadata.schema.json",
  "title": "AssetDump v2 Script Metadata Facts",
  "description": "Per-MonoScript fact rows capturing Unity metadata, assembly linkage, and scene provenance when available.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "domain",
    "pk",
    "collectionId",
    "pathId",
    "classId",
    "className",
    "fullName",
    "assemblyName",
    "isPresent"
  ],
  "properties": {
    "domain": {
      "type": "string",
      "const": "script_metadata"
    },
    "pk": {
      "$ref": "../core.schema.json#/$defs/StableKey"
    },
    "collectionId": {
      "$ref": "../core.schema.json#/$defs/CollectionID"
    },
    "pathId": {
      "type": "integer",
      "description": "Unity m_PathID for the MonoScript asset."
    },
    "classId": {
      "type": "integer",
      "description": "Unity ClassID for MonoScript (typically 115)."
    },
    "className": {
      "type": "string",
      "description": "Short class name recorded on the MonoScript (from ClassName_R)."
    },
    "fullName": {
      "type": "string",
      "description": "Fully qualified type name derived from namespace and class name (from MonoScriptExtensions.GetFullName())."
    },
    "namespace": {
      "type": "string",
      "description": "Namespace declared on the MonoScript."
    },
    "assemblyName": {
      "type": "string",
      "description": "Managed assembly name after applying SpecialFileNames.FixAssemblyName() (Assembly-CSharp, etc.). Use GetAssemblyNameFixed() method."
    },
    "assemblyNameRaw": {
      "type": "string",
      "description": "Original assembly name as recorded in the MonoScript, before FixAssemblyName() processing."
    },
    "isPresent": {
      "type": "boolean",
      "description": "Whether the script type definition is present in the loaded assemblies (from MonoScriptExtensions.IsScriptPresents())."
    },
    "isGeneric": {
      "type": "boolean",
      "description": "Whether the script is a generic type definition."
    },
    "genericParameterCount": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of generic type parameters if isGeneric is true."
    },
    "executionOrder": {
      "type": "integer",
      "description": "Execution order recorded on the MonoScript importer."
    },
    "scriptGuid": {
      "$ref": "../core.schema.json#/$defs/UnityGuid",
      "description": "Unity GUID derived from the MonoScript content hash."
    },
    "assemblyGuid": {
      "$ref": "../core.schema.json#/$defs/UnityGuid",
      "description": "Unity GUID derived from the assembly name."
    },
    "scriptFileId": {
      "type": "integer",
      "description": "MonoScript file identifier as computed by Unity hashing."
    },
    "propertiesHash": {
      "type": "string",
      "pattern": "^[0-9a-f]{8}$|^[0-9a-f]{32}$",
      "description": "Lowercase hex representation of MonoScript m_PropertiesHash. May be 8 chars (UInt32 for old versions) or 32 chars (Hash128_5 for new versions)."
    },
    "scene": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "name",
        "path",
        "guid"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "Scene name when the script is sourced from a scene collection."
        },
        "path": {
          "type": "string",
          "description": "Project-relative path of the source scene."
        },
        "guid": {
          "$ref": "../core.schema.json#/$defs/UnityGuid",
          "description": "GUID recorded for the source scene asset."
        }
      }
    }
  }
}