{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schemas.assetripper.dev/assetdump/v2/facts/script_metadata.schema.json",
  "title": "AssetDump v2 Script Metadata Facts",
  "description": "Per-MonoScript fact rows capturing Unity metadata, assembly linkage, and scene provenance when available.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "pk",
    "collectionId",
    "pathId",
    "classId",
    "className",
    "fullName",
    "assemblyName"
  ],
  "properties": {
    "pk": {
      "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#/$defs/StableKey"
    },
    "collectionId": {
      "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#/$defs/CollectionID"
    },
    "collectionName": {
      "type": "string",
      "description": "Friendly name of the serialized file that owns the MonoScript."
    },
    "bundleName": {
      "type": "string",
      "description": "AssetBundle that supplied the owning collection, if applicable."
    },
    "collectionFlags": {
      "type": "string",
      "description": "Bitflag string describing Unity SerializedFile flags."
    },
    "collectionPlatform": {
      "type": "string",
      "description": "Unity build target for the owning collection."
    },
    "collectionVersion": {
      "type": "string",
      "description": "Unity version recorded on the owning collection."
    },
    "collectionFilePath": {
      "type": "string",
      "description": "Relative file path for the serialized collection on disk."
    },
    "isSceneCollection": {
      "type": "boolean",
      "description": "True when the MonoScript originates from a Scene collection."
    },
    "pathId": {
      "type": "integer",
      "description": "Unity m_PathID for the MonoScript asset."
    },
    "classId": {
      "type": "integer",
      "description": "Unity ClassID for MonoScript (typically 115)."
    },
    "className": {
      "type": "string",
      "description": "Short class name recorded on the MonoScript."
    },
    "fullName": {
      "type": "string",
      "description": "Fully qualified type name derived from namespace and class name."
    },
    "namespace": {
      "type": "string",
      "description": "Namespace declared on the MonoScript."
    },
    "assemblyName": {
      "type": "string",
      "description": "Managed assembly name (Assembly-CSharp, etc.)."
    },
    "executionOrder": {
      "type": "integer",
      "description": "Execution order recorded on the MonoScript importer."
    },
    "scriptGuid": {
      "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#/$defs/UnityGuid",
      "description": "Unity GUID derived from the MonoScript content hash."
    },
    "assemblyGuid": {
      "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#/$defs/UnityGuid",
      "description": "Unity GUID derived from the assembly name."
    },
    "scriptFileId": {
      "type": "integer",
      "description": "MonoScript file identifier as computed by Unity hashing."
    },
    "propertiesHash": {
      "type": "string",
      "pattern": "^[0-9a-f]{32}$",
      "description": "Lowercase hex representation of MonoScript m_PropertiesHash."
    },
    "scene": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string",
          "description": "Scene name when the script is sourced from a scene collection."
        },
        "path": {
          "type": "string",
          "description": "Project-relative path of the source scene."
        },
        "guid": {
          "$ref": "https://schemas.assetripper.dev/assetdump/v2/core.schema.json#/$defs/UnityGuid",
          "description": "GUID recorded for the source scene asset."
        }
      }
    }
  }
}
